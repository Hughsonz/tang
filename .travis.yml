language: c
before_install:
  - sudo apt-get remove -y 'erlang.*' 'jdk.*' 'openjdk.*' 'ruby.*' 'libqt4.*' google-chrome-stable
  - sudo apt-get remove -y 'postgres.*'
  - sudo apt-get autoremove
  - sudo sed -i 's|trusty|wily|g' /etc/apt/sources.list
  - sudo apt-get update -y
  - sudo apt-get -o Dpkg::Options::="--force-confnew" dist-upgrade -y
  - sudo apt-get -o Dpkg::Options::="--force-confnew" install -y libsystemd-dev libssl-dev libcryptsetup-dev automake autoconf make gcc clang
before_script:
  - autoreconf -if
script:
  - ./configure --prefix=/usr
  - make -k
  - make check
  - pushd src/tests; strace ./keyd; popd
sudo: required
dist: trusty
compiler:
  - clang
